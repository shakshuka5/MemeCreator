<!doctype html>
<html>

<head>
    <style>
        .image-canvas {
            border: 5px solid blue;
        }
    </style>
    <title>MemeFlow</title>
</head>

<body onload="init()">


    <!--<canvas id="image-canvas" class="image-canvas" width="600px" height="600px" ></canvas>-->
    <canvas id="image-canvas" class="image-canvas" width="500px" height="500px"></canvas>
    <img src="assets/meme1.jpg" alt="hidden-image" class="hidden-image" id="hidden-image" style="display:none;"></img>

    </div>
    <br><br>

    <div id="inputs-zone">
        <input id="topline" placeholder="TOP LINE" oninput="inputWrite(this)">
        <br><br>
        <input id="bottomline" placeholder="BOTTOM LINE" oninput="inputWrite(this)">
        <br><br>

        <br><br>
        <a href="#" class="buttonLink" id="downloadLink" download>Download Your Meme!</a>
        <br><br>
        <a href="">Make Another Meme!</a>

    </div>
    <br><br>
    <hr>

    <script>
        "use strict";


        var canvas = document.getElementById("image-canvas");
        var ctx = canvas.getContext('2d');
        var deviceWidth = 600; // fix to VARIABLE
        var canvasWidth = deviceWidth - 40;
        var img;
        var aspectRatio;
        var canvasHeight;
        var imgx = 0;
        var imgy = 0;
        var el = {};
        var gFontSize = 30;
        var gFontType = "Impact, Charcoal, sans-serif";

        function init() { //load start

            img = document.getElementById("hidden-image");
            aspectRatio = img.height / img.width;
            canvasHeight = Math.floor(canvasWidth * aspectRatio);
            el.topline = document.getElementById("topline");
            el.bottomline = document.getElementById("bottomline");


            canvas.width = canvasWidth;
            canvas.height = canvasHeight;


            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.drawImage(img, imgx, imgy, canvas.width, canvas.height);




        }

        function writeText(text, x, y) {
            var f = gFontSize; // Font size (in pt)
            for (; f >= 0; f -= 1) {
                ctx.font = "bold " + f + "pt " + gFontType;
                if (ctx.measureText(text).width < canvasWidth - 10) {
                    ctx.fillText(text, x, y);
                    ctx.strokeText(text, x, y);
                    break;
                }
            }
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.drawImage(img, imgx, imgy, canvas.width, canvas.height);

            ctx.textAlign = "center";
            ctx.fillStyle = "white";
            ctx.strokeStyle = "black";
            ctx.lineWidth = 2;
            writeText(el.topline.value, canvasWidth / 2, 50);
            writeText(el.bottomline.value, canvasWidth / 2, canvasHeight - 20);

        };

        function inputWrite(text) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.drawImage(img, imgx, imgy, canvas.width, canvas.height);
            console.log(text.value);
            ctx.font = "bold " + gFontSize + "pt " + gFontType;
            ctx.textAlign = "center";
            ctx.fillStyle = "white";
            ctx.strokeStyle = "black";
            ctx.lineWidth = 2;

            ctx.fillText(el.topline.value, canvasWidth / 2, 50);
            ctx.fillText(el.bottomline.value, canvasWidth / 2, canvasHeight - 20);

            ctx.strokeText(el.topline.value, canvasWidth / 2, 50);
            ctx.strokeText(el.bottomline.value, canvasWidth / 2, canvasHeight - 20);

        }

    </script>



</body>

</html>